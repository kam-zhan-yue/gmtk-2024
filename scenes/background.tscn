[gd_scene load_steps=25 format=3 uid="uid://dtbawr3acmc0s"]

[ext_resource type="Script" path="res://scripts/entities/visible.gd" id="2_ybn17"]
[ext_resource type="Script" path="res://scripts/boids/boid_remover.gd" id="3_ete7q"]
[ext_resource type="Texture2D" uid="uid://bj8ibwi80ledu" path="res://assets/background/ocean/water.png" id="3_u8h6g"]
[ext_resource type="Texture2D" uid="uid://kspwkc64iq2u" path="res://assets/background/ocean/mountain.png" id="4_krqt6"]
[ext_resource type="SpriteFrames" uid="uid://uj314hdt765p" path="res://scenes/animations/lighthouse.tres" id="4_m14t6"]
[ext_resource type="Texture2D" uid="uid://d0r14pr4gmh1l" path="res://assets/background/sky/red2_mountain.png" id="4_myvpw"]
[ext_resource type="Texture2D" uid="uid://nsmypwfg2i62" path="res://assets/background/sky/red3_mountain.png" id="5_dxom7"]
[ext_resource type="Texture2D" uid="uid://3whi06gf73tq" path="res://assets/background/ocean/cavern.png" id="5_nhxmj"]
[ext_resource type="Script" path="res://scripts/entities/chimney_smoke.gd" id="5_sj3r0"]
[ext_resource type="Texture2D" uid="uid://bbtvt5h0rfj2u" path="res://assets/background/sky/red_mountain.png" id="6_cyjm7"]
[ext_resource type="Texture2D" uid="uid://bmdpgfudjp7li" path="res://assets/background/sky/gradient_to_space.png" id="6_d8em3"]
[ext_resource type="Texture2D" uid="uid://b2liahtmr41dl" path="res://assets/background/sky/main_mountain.png" id="7_e730v"]
[ext_resource type="Script" path="res://scenes/cloud_layer.gd" id="9_js5oi"]
[ext_resource type="Texture2D" uid="uid://cmmmriydvrp0" path="res://assets/background/sky/closer_clouds.png" id="9_v7ua1"]
[ext_resource type="Shader" path="res://scripts/shaders/distortion.gdshader" id="11_lqyho"]
[ext_resource type="Texture2D" uid="uid://dqvskjwyyutv1" path="res://assets/background/lighthouse_island.png" id="12_43gme"]
[ext_resource type="Texture2D" uid="uid://c1qj3u4hvqn2n" path="res://assets/textures/dot.png" id="12_dnxis"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_avv3c"]
size = Vector2(600, 834)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_557np"]
noise_type = 3

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_lv72p"]
seamless = true
noise = SubResource("FastNoiseLite_557np")

[sub_resource type="FastNoiseLite" id="FastNoiseLite_d6owk"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_ces5y"]
seamless = true
noise = SubResource("FastNoiseLite_d6owk")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_33mok"]
shader = ExtResource("11_lqyho")
shader_parameter/distortion_strength = 0.00300005
shader_parameter/offset1 = Vector2(0.1, 0.1)
shader_parameter/offset2 = Vector2(0.2, 0.2)
shader_parameter/noise_texture1 = SubResource("NoiseTexture2D_lv72p")
shader_parameter/noise_texture2 = SubResource("NoiseTexture2D_ces5y")

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_8s7ep"]
polygon = PackedVector2Array(304, -462, 242, -466, 201, -458, 169, -447, 127, -434, 93, -421, 77, -404, 66, -373, 60, -360, 63, -314, 55, -275, 53, -249, 49, -237, 56, -222, 84, -155, 106, -139, 133, -117, 118, -78, 90, -55, 54, -27, 48, -7, 52, 11, 78, 39, 328, 45)

[node name="Background" type="Node2D"]
z_index = -1

[node name="VisibleAreas" type="Node2D" parent="."]
visible = false
position = Vector2(2, -450)

[node name="Area2D" type="Area2D" parent="VisibleAreas"]
position = Vector2(0, 674)
collision_layer = 4
collision_mask = 4
script = ExtResource("2_ybn17")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="VisibleAreas/Area2D"]
polygon = PackedVector2Array(-27, 117, 23, 56, 39, 48, 33, -35, 31, -59, 83, -116, 94, -172, 53, -211, 48, -233, 58, -250, 87, -264, 131, -313, 136, -334, 127, -345, 96, -363, 66, -425, 48, -457, 65, -548, 80, -627, 107, -647, 212, -679, 244, -686, 276, -685, 299, -685, 302, -1606, -298, -1607, -301, -700, -101, -640, -61, -553, -54, -468, -62, -422, -74, -395, -71, -338, -57, -268, -67, -219, -36, -138, -65, -91, -85, -65, -82, -30, -52, 3, -38, 33, -44, 77)

[node name="BoidRemover" type="Node2D" parent="."]
visible = false
position = Vector2(0, -443)
script = ExtResource("3_ete7q")

[node name="Area2D" type="Area2D" parent="BoidRemover"]
collision_layer = 4
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="BoidRemover/Area2D"]
position = Vector2(0, 399)
shape = SubResource("RectangleShape2D_avv3c")

[node name="Lighthouse" type="Node2D" parent="."]
position = Vector2(0, 15)

[node name="LighthouseIsland" type="Sprite2D" parent="Lighthouse"]
position = Vector2(0, -581)
texture = ExtResource("12_43gme")

[node name="ChimneySmoke" type="AnimatedSprite2D" parent="Lighthouse"]
position = Vector2(-205, -743)
sprite_frames = ExtResource("4_m14t6")
animation = &"smoke"
frame_progress = 0.0116177
script = ExtResource("5_sj3r0")

[node name="Sky" type="ParallaxBackground" parent="."]

[node name="Gradient" type="ParallaxLayer" parent="Sky"]

[node name="Sprite2D" type="Sprite2D" parent="Sky/Gradient"]
position = Vector2(0, -894)
texture = ExtResource("6_d8em3")

[node name="RedMountain3" type="ParallaxLayer" parent="Sky"]
position = Vector2(-1, -471)
motion_scale = Vector2(1, 0.7)

[node name="Sprite2D" type="Sprite2D" parent="Sky/RedMountain3"]
texture = ExtResource("5_dxom7")

[node name="RedMountain2" type="ParallaxLayer" parent="Sky"]
position = Vector2(-1, -471)
motion_scale = Vector2(1, 0.8)

[node name="Sprite2D" type="Sprite2D" parent="Sky/RedMountain2"]
texture = ExtResource("4_myvpw")

[node name="RedMountain1" type="ParallaxLayer" parent="Sky"]
position = Vector2(-1, -471)
motion_scale = Vector2(1, 0.86)

[node name="Sprite2D" type="Sprite2D" parent="Sky/RedMountain1"]
texture = ExtResource("6_cyjm7")

[node name="Clouds" type="ParallaxLayer" parent="Sky"]
position = Vector2(0, -471)
motion_mirroring = Vector2(602, 0)
script = ExtResource("9_js5oi")
cloud_speed = 5.0

[node name="Sprite2D" type="Sprite2D" parent="Sky/Clouds"]
position = Vector2(-9, -94)
texture = ExtResource("9_v7ua1")

[node name="MainMountain" type="ParallaxLayer" parent="Sky"]
position = Vector2(-1, -471)
motion_scale = Vector2(1, 0.9)

[node name="Sprite2D" type="Sprite2D" parent="Sky/MainMountain"]
texture = ExtResource("7_e730v")

[node name="Water" type="ParallaxBackground" parent="."]

[node name="Water" type="ParallaxLayer" parent="Water"]

[node name="Sprite2D" type="Sprite2D" parent="Water/Water"]
texture = ExtResource("3_u8h6g")

[node name="Distortion" type="Sprite2D" parent="Water/Water"]
material = SubResource("ShaderMaterial_33mok")
texture = ExtResource("3_u8h6g")

[node name="Node2D" type="Node2D" parent="Water/Water"]

[node name="DirectionalLight2D" type="DirectionalLight2D" parent="Water/Water"]
position = Vector2(527, -820)
rotation = 0.788417
energy = 0.4
blend_mode = 2
range_layer_min = -100
shadow_enabled = true

[node name="Lighting" type="Node2D" parent="Water/Water"]

[node name="CanvasModulate" type="CanvasModulate" parent="Water/Water/Lighting"]
color = Color(0.800491, 0.800491, 0.800491, 1)

[node name="PointLight2D" type="PointLight2D" parent="Water/Water"]
position = Vector2(-7, -448)
range_layer_min = -10
range_layer_max = 10
texture = ExtResource("12_dnxis")
texture_scale = 3.0

[node name="Distortion" type="ParallaxBackground" parent="."]
layer = 10

[node name="Water" type="ParallaxLayer" parent="Distortion"]

[node name="Distortion" type="Sprite2D" parent="Distortion/Water"]
material = SubResource("ShaderMaterial_33mok")
texture = ExtResource("3_u8h6g")

[node name="Caverns" type="ParallaxBackground" parent="."]
layer = 20

[node name="Cavern" type="ParallaxLayer" parent="Caverns"]
position = Vector2(16, 0)
motion_scale = Vector2(1, 1.1)

[node name="Sprite2D" type="Sprite2D" parent="Caverns/Cavern"]
texture = ExtResource("5_nhxmj")

[node name="LightOccluders" type="Node2D" parent="Caverns/Cavern"]
position = Vector2(-16, 0)

[node name="LightOccluder2D" type="LightOccluder2D" parent="Caverns/Cavern/LightOccluders"]
occluder = SubResource("OccluderPolygon2D_8s7ep")

[node name="Mountain" type="ParallaxLayer" parent="Caverns"]
motion_scale = Vector2(1, 1.2)

[node name="Sprite2D" type="Sprite2D" parent="Caverns/Mountain"]
texture = ExtResource("4_krqt6")

[connection signal="area_entered" from="VisibleAreas/Area2D" to="VisibleAreas/Area2D" method="_on_area_entered"]
[connection signal="area_exited" from="VisibleAreas/Area2D" to="VisibleAreas/Area2D" method="_on_area_exited"]
[connection signal="area_exited" from="BoidRemover/Area2D" to="BoidRemover" method="_on_area_2d_area_exited"]
